apiVersion: v1
kind: ConfigMap
metadata:
  name: d10webservice-configmap
data:
  run_webservice.sh: |
    #!/bin/bash
    hostname deadline-server
    mono --version
    ulimit -u unlimited
    source ${{ .Values.destination }}/service/deadline_env.sh
    export DEADLINE_PATH=${{ .Values.destination }}/client
    export DEADLINE_CUSTOM_PATH=${{ .Values.custom_plugins_path }}
    echo "----------------------------------------------------"
    echo "Starting up Terra service for: Deadline10 Webservice"
    echo "----------------------------------------------------"
    mkdir -p /var/lib/Thinkbox/
    mkdir -p /var/lib/Thinkbox/Deadline10
    cp -v $TERRA_DEADLINE_PATH/service/deadline.ini /var/lib/Thinkbox/Deadline10/deadline.ini
    cd $TERRA_DEADLINE_PATH/client/bin
    ./deadlinewebservice.exe 
    echo "Terra service for Deadline10 Webservice is running"
    # sh -c tail -f /dev/null
