apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WXW/bNhTNs37FnTNgD6ske01ioAMGBG0eDATpsCRP61DQEhMRkUiOpJx4v36HEm3LjtP6oUU3lCeAbVL389wPxRZGaGfzo6+IMTA9Pe2+gd3v578nk1/GJ0d0+jWDWqG1jhmiI6OU+5Tc557/T2FD/bl0ZqmVkC6z1Rf24Yt6dnLyUv1fn51Odur/eno2PqLxF45jL77z+h//kM+FzOfMVkliuaOUJ7yoFI2uwYsT8p42rUF9t2RZNkqSYyoqXjyQq5jDB6d3F9c3s6vzm9n7K+gshFGygS4tmBFsXnMSluAhEXf0J6X/0OjHgcaI/vrVW5EJUe//EHNSOW8yo4sn4WNFXFDHb5okd2ITI1z6CGdX1zfnl5efiq6LgVpdMsc7Hbu0jjchaImgg5FhwMc0b0VdrmSJmHbBRjgIiTara0qXdC9c0ukUJTnV+Si5RfTMCSWpFIYXTpklZJoHnCjVO1ThCXSf3enHEp+1pbRmwUOtZJ+F4VpZ4c16LsBPqbiVPzlPlgV/s/Vlf/PKe0DFlb9mslwxgtiJei4QQaGau2UrhlSsqvfWP7qdbdIhVhvOymVv32Z06y36mmVd1bqcgsHuCJ5It+BMGXEvJDUM5Bpf39ryoSck6dt05XGT6tqyN9VzUTmn7Zs8x03VzjP4yzufTCq5bFRr82Am8zppWnLtKppsBbYVp+8yT7WGW2Z6svXSVajkoMt8dYRed0G7wEW7oAVE8Muq1hScMn/sppEVTiz65oHUUDNNpUoLhq6m1CDVv1vw6z3YzD25nfKDL43CERtWAbUsUAjUkpGf+jDT/Rg/CvjY9CWbW1W3ENUMLKhuiDrLexuWdN3aTi/Qs+PWtHKQYyCpYUJmeonEarQFRm+cdX99j2fZeh0MFtWIfvPGPgY3eGGtpaDzYWsw8iD0YQStF9UODmufkY4RFEc9dsmr1unW2VfUqBKtiknCK0Y1HyWOOHkmhITEmh2BoQPhFVtwejTC081NI6wFu9bzUMESpX/QdDqlvcnlwefoMOk+sAOFh9EfqNKlN+p5adhD2KN9m/EnXrTOL9y1rZ+f9jC6vUVC+/cN5xnEpkZjQ0XX3PESc75n3b+9vDi/uv39gJeR3+tBenuvY7jUok/g3QtLerWFOOvWEMJ6caWHhWQaDO/d8wU+sPQ8uW/9j0JERERERERERERERERERERERERERERERERERMR/Hv8CWIo3vAAoAAA="