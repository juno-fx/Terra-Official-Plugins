apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WXW/bNhTNs3/FrVK0QFdJcZrEwAoMCNoMMBBkw5L0ZR0CWqIjIhKpkZQS99fv8kOy7MidH1oMxXgCxBbF+3Xu4aVVJlmtVXrwHXGEmJ2e2k/E9ufz79Pp8dHJAZx+z6Q6NEoTCXAghdBf2/dv739QKN9/yrVc1YJxnajiG8cwTT07OdnV/5Oz49lW/9/NzrD/R984j1H8z/t/+CJdMJ4uiComE0U1xHRCs0JAdI28aMbvYS0NcGpJkiSaTA4hK2j2ALogGv9R+HhxfTO/Or+Z/3aFNi2TgldoCy2RjCxKCkwBRpiwJfwJ8ReIXg4sIvjrvfHCJwAu/j7uuNDGZQIXT8zkinmhOX6H6WTJ1jliSJPh/Or65vzy8mvZ2RygqXOiqbVRK6Vp5ZPmmLR3Mkz4EBYNK/NuLwCptffhHxhHmZUlxCu4Z3pibbIctLAxcqowe6KZ4JAzSTMt5Ar3VA/4BHG9RRW+QdutNeeyFNylLWktFDN+TPFISC6o4q+1YUchYfN+0a28NS6xxcIsE553FGCyAK54DJmJarlq2LD2rl0fzKvb+Tp/IKWkJF85/yqBW+PRNCmxbbJFeIf2EYmBukGShGT3jENFkE1pGloqOoyERRpddhHXpfaejSvHRaF1rX5OU1wpmkWC8VIbk3DBV5VoVOrdJMYmjnNa6wKmG4lt5GlkZaiuMSyRjux6pQts3UBWuKVmdd/2pnVG3bM38O3vZdO03ZteL0uIUQEM1++6tXfJ9NhJYL2Iz7LCrUt4YwP9yrCFVlp9O+w5NcNOK3hENrCbLlgc2YZLykllGm7Sitwrw+ZSSDDSgG77m/eoG0uME8XLHPUAr15B1ULcumdfBi4uUAQPuDvHbriskyT1asVX/pQhcboh5cbJHNFtp8UXNnDS4vZRLRrHRiIjbnuNINnGHqyXZ4cs9R1P1xynrig7L9f0bInz00ghWwchcioCUKKRGXUJWK8k06x1Q8NIYSCgOOYizghOM6MHSf9usK/GuUr0k58nKKIajy2Q4RnExnqaCZgh70e4U8MjQ9frMUQWSpQNbq0JykPYmWk9j84nqMtGWTtP1VZY2fBBaV4QFWE8qVdYT4lc4KQ9Suxfp4x++g/upQh+Mc7ufBj8fdLvQpvPo237HKHVTrO90xpzYhnBnohHW7xodN1o9RYqkaMWcI7iLwpR3XF8xCfDBOO4o2eH4chFwgvSUniUzNBNZcWUQnaV4aFATxD/AbPZbIcmXcxov80urz03D5Pf08RW5++fijz4W9OpjD7RrNHmeu19/fQ0QujmFeJF7/RmCMR7GXWNJnVJNc3xBI1c7h8uL86vbn/f46eHucX97s1bHI+UaF0BH3dcyd0VRIm9gzCtnRe4nzR+Lj+7wgeenhf3X/8sDAgICAgICAgICAgICAgICAgICAgICAgICPhB8Q9W+yC0ACgAAA=="