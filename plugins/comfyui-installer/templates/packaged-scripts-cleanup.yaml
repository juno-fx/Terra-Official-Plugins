apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1YW2/bNhTOs37FqVPsGkpxEidAhxUo2j4Y6LKiSfayDgEj0RYRiVR5ceyt++87FClHthW3HtoV23QCxDJ1bjyX75DWqeKV0cneZ6RDpLPRqP5EWv9sPZ8cD4/weTg8Gp7uwehzOtWQ1YYqgD0lpdnG96H3/1LSIf9MGLWoJBcm1vkntuEye3py8lD+h0NM9mr+j89OT/bg8BP70Un/8/zvP0puuEhuqM6jSDMDhEUszSUMLjAuhosp3JcG+GqJ43gQRfuQ5iy9BZNTg/8YvHh5cTk+f3Y5/vkcZWZcSVGiLMyo4vSmYMA1oIWIT+BXIL/D4HFLYgC//eC0iAjA2/8YdUIapzKGl3PufEW/UByfYRhN+L2PaNJ5OD6/uHz26tU272ofwFYZNayW0QttWBmcFuj0H0HLn22XAeKECyylomAKO2htc13OPH/18tn51euPCJWzGrjbNvdBsVLOvJsvmMYAUMOlgIwrlhqpFstYPi8YFS6Xtqq5sy7uOq0AqgSiJqsbSFJZThaWD1Y1ojZ8URXMsCx2m/zS1dzTrtTgf7t4P7WND+D/6HQT/0ejsx7//wkKkI/gdGN5kTVwRysTQLB+DNUBZAFTbqIoQOD1i/GbHx8ACkS7DIx8GG6i8hafgVTrWIlyayseclpamqUutpZvS7aVNfSskMLDpmKV1Ny542AZ50YmmRZfGzdENM6V8XLRrxy4XeEklG6ZiqyZFLzBavS9CcHGRHvuXlyN70MAtFCMZguvW8dw5bS5OeahGG0FZfgFAw+VxSRIxadcQEkxUypihWYtVJY1zDeW7rcXNDolfve5MZV+kiS4ktubGO343FEhxaKUVidBSexkCMlYZXIYthxqeefHW4XmqPKBrRYmx2y3hltU8WpZSHbmBJpvgTlUSyjBfZeRduaSanEdJJLUi5DjeHgUD4ek4MLOyVRYnyt3Lgj5qud5Y6hJ06M6UTsr30zp2Iu4mL/2mwhCId521mxu2UITHK9AONwbbGSQv5ztuOXv6k3/ja2sFs6q88u6bKaCn+71EQZfhJMRZtZYWqwcYDqaqB3xeIbMHY3hlLoYdqgMgfSMV7oV6YmS5ZPdKySkxXkCtT8egnZVUx+b/cu1WP7SEZe1Rq+jqaVVKfM+1NpoavjMQa6rmlazECIkSSmeHl3pKPbOIoA4tTo2c7POjd2e5v7/jGte9xU+U5txiarY3ChKuMjYnFhVLHEgk3eikDSLcU+OP5ZqmtzlGAE7PD5EwQmuMqJYsNPu3wADCEliipDkgAHHqiyvhUTQjqIadaSY8GmNYLFieN9gMKEubBvnYg875CcqKGproaUP3kGryA5A3+LWUw97GxBMSq/jQSjuMLKWKVd92yB2qWE3qC1MphDqabKuZs1zVyf3OLtc3ZwFXOxYNag1jhMXfWSWd3XopTWVdREuMW8FfrbTeFDPOy6QYxkujliLqJ1TvIXcKY7AUDFVcu3KTrcHfLu7rMaMPPQSkb/CI0COHgB5A2ejUaf0FoYPavC73Mri97+VpR2arYx1xOr7Mo61yt3AaLvcMKYBUym4W3i4Y/tr9R133bU8R9EbLQvrokxxFsu6X1Bv5/EKqsLqWqrpzlWjyooW9IQh5eoIAQBrp8Dqx8F5GNd/vloifzWcOdnroBWvC+GQ1folYQBPu3lQzduV6LwdIO8DzB/tnUM14a7NJJVKkxz7Fzvp7eNvUGXp9kpmgFiccUp0yeFpkrFZIlz7HD39agjv3/vWJiSt7Ldd/mCMS3obfg/w6WFzllrjjIbcfz/fkFo99YW+9GlyXuHRe+0CHX3p20BPPfXUU0899dRTTz311FNPPfXUU0//NfoLXOVj4QAoAAA="