apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WS2/bRhD2mb9iQhfIoSFpNXYEtEABI/FBgOEWtd1LUwQrcm0uTO5u9yFb/fWdfYiiZDrVIUHRdj8Dkric5zezM9a1YtLo6ugr4gQxPzvz34j97+e/Z7PvTk6P4OxrBrWB1YYogCMlhPmc3N+9/5dCx/pTbtRaCsZNqdsv7MMV9d3p6Uv1P53NZ3v1fzs/e3cEJ184jkn8z+t//KpaMl4tiW6zTFMDBc1o3QrIr5EXw/g9bFsDQreUZZln2THULa0fwLTE4AeFDxfXN4ur85vFT1eos2JK8B51YUUUI8uOAtOAHjJ2B79B8Sfk34w0cvj9B2eFZwDB/yHmuDDOZAkXT8zFinGhOv6GWXbHtjGiSxfh4ur65vzy8nPR+RjAyoYY6nX0Whvax6A5Bh2NjAM+hqVlXbORBSDSRBvxgXFss66DYg33zGRep27ACO+joRqjJ4YJDg1TtDZCrVGmf8AnKOQeVfgGdZ+dyccGPzsNRUeih07wkIWiUmjmzDoukJ9GUM1fG0eWRv4Ww2E4eeM8YMWFOya82TCCsQMELjCCWvR3a8vGVGyq9969ul1s0wHSKUqadbCvS7h1Fl3NSl81n1M06B+RJ5AWOROK3TMOPUFylatvp+nYEybp2nTjcZvqYNmZCly0xkj9fVXhSWuXJfqrvE/CBV/3wuoqmimdTlE0VJoWZjuB7cTpusxRLdEtUYFsuTYtVnLUZa46TA5dYFexPshIbDMUNZZ0O605USlUUz0U6g7KFYpuivHKl8MfTRbD+XEcTXgZSLIrcPqD4T2af50IcK+keeADQAurahos+fFCasNW4TagmzEVRcFFURO8ppgV1u4Piw3jjOvSPJm9fsYGkNiJQMZthc0ZeSTgxlgcUmEuPTL0sb1oZKlFZ1FUEiyr8FPBW568gSA7q71erPeeW2X5KMdY9Z4wXso1JtYhKThLTkr/Fy5tWQ7zbTR5c/jRGfsU3eAGHqRQ5+POTa+i0McctV5UOzisKSOeESyOePTJC2ukNfoN9KLBpsDRgDtT9J84PuKTY4JxlBjYYThFkPCWrCg8KubopqpnWiO72vHQoiUofoH5fA6TyVXBZ36YcIjrQOFx8Aeq+OzyQEtPHuJeCF1Gn2htjVsgg61vnyYI3Z2KsftDvzkCcfNgX6OK7KihDV6lifX1/vLi/Or25wOWq9tTUXp3T+HdEquQwIcXls5mqlLixyqG9eKKirMjTqRnC2lk6Xly//Q/PgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJ/0H8BXIjxH8AKAAA"