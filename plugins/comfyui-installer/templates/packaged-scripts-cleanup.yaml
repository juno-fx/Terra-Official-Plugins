apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WW2/bNhTOs3/FqTOgD6tku4njoQMGBG0eAgRZsSR9WYeAluiIiERqvDj2fv0OL5JlR248IMUwjJ8B26LO9TuHh1SZZLVWo6PviDFiNp26X8Tu7/P/k8n78ekRTL9nUA2M0kQCHEkh9LfkXnr/H4UK9adcy3UtGNepKl7Zhy3q2enpvvpPx+OTnfqfzKaTIxi/chy9+J/X//jNaM74aE5UMRgoqiGhA5oVAoY3yItm/AE2rQG+W9I0HQ4Gx5AVNHsEXRCNXxQ+XdzcXl6f317+eo06SyYFr1AXlkQyMi8pMAXoYcAW8Dskf8Hwh47GEP742VrhAwDv/xBzXGhrMoWLFbOxYlyojv9hMliwTYzo0kZ4eX1ze3519a3oXAxg6pxo6nTUWmlahaA5Bh2MdAM+hrlhZd7IApBaBxvhgXFss7KEZA0PTA+cTpaDFs5HThVGTzQTHHImaaaFXKNM9YhPkNQ7VOEb1N1Z8yZLwX3YktZCMWvHJo+E5IIq/lZbdhQSdtku+pV31iSWWNhlwvOGAgwWwCePLjNRLdaGdXNvyvXRvrq73MQPpJSU5GtvX6VwZy3aIqWuTC6JYNA9IjFQGyRJSPbAOFQE2ZS2oKWiXU+YpO3LxuMm1dayNeW5KLSu1YfRCFcKM0/R38j5JFzwdSWMGgUzqdVJkpzWuoDJVmBbcdq2slTX6JZIT3a91gWWrtNWKFKzui27WXql5jkohPK3bWOWzZu2XxaQYAcwXL9v1k7Syft0MgkVR45Dp6JzbUi51d09tW/q+cZVNF2ieG89rWFLc4/Zlmcveqes3Gcf+UKK6gN0e3MUyBttchhlPs8k5JKUjJtVsvrp7P7sNHngxg0lL+M9ITU2UnDxPtsSr+Bip8m+9JC509BD3w0AShiZUR+as0oyzZZ+89uSdhohSbhIMoJTydZV0j8NbhdrXKV6FeYCNkON2w9Idy/hjgylJmCHdRjFfvo+MTS9GSdkrkRpULQm2MvCzT5nuXfOQF0a5fQCiTtupeGd1EJ/VoTxtF5jPiVygRNznLqPH01p2k7xzvkyhF+ssfvgBu8ZrRTqfO0t6Nchau1VOzisPiOOEayJeHLJC6Nro9U7qESOvYDzEG8Gorrn+IhPlgnGUaJlh+HoRMILsqTwJJmlm8qKKYXsqr3Du+1Uo6gcviyGg6F2A7/AuCD5DWaz2QsWDxD9B1Y9LwcKe+4OFO4SfKCKq0A46yryGE5ovxPoimZG26O8tfXjqqfo28dV2Jh+T9gi4x0A9x6q1CXVNMdd3nOR+Hh1cX599/mAa469MQTp7RsDbnux9Al82nP8N8cdJe68w7D2XhbCRJYVjpXF8+tCx9Lz5P7tK2hERERERERERERERERERERERERERERERETEK+Jv/eJlGwAoAAA="