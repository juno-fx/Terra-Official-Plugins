apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WXW/bNhTNs37FnTNgD6ukpElqYAMGBG0eDATZsCRP61DQEhMRkUiOpJx4v36HFG3LidP5ocVQjCeAbVL389wPxVZGaGfLg6+II2B6dha+geffL38fH789Oj2gs68Z1Aq9dcwQHRil3Ofk/u35Nwob68+lM0uthHSFbb6wD1/Ud6enr9X/5N3bk2f1P5meTQ/o6AvHsRP/8/offlfOhSznzDZZZrmjnGe8ahRNrsGLE/KeNq1BQ7cURTHJskOqGl49kGuYwwenDxfXN7Or85vZr1fQWQijZAddWjAj2LzlJCzBQybu6A/K/6bJ9yONCf35s7ciM6LB/z7mpHLeZEEXT8LHirigjt90nN2JTYxw6SOcXV3fnF9efi66EAP1umaOBx27tI53MWiJoKORccCHNO9FW69kiZh20UY8CIk2a1vKl3QvXBZ0qpqcCj5qbhE9c0JJqoXhlVNmCZnuASfK9TOq8AS6L+70Y43P1lLesuihVXLIwnCtrPBmPRfgp1bcyh+cJ8uCv9n6crh54z2g4spfM1mvGEHsRAMXiKBS3d2yF2MqVtV77x/dzjbpEGsNZ/VysG8LuvUWfc2KULWQUzQYjuCJdA/OlBH3QlLHRGiO1vKxH6Tom3Tlb5Po2q43NDDROKftT2WJm6afF/BWBo9MKrnsVG/LaKbwOnlec+0aOt4KaytK32OeaA23zAxU66VrUMdRj/naCL3ugX6Bi35BC4jgl1W9qTgV/hhmkVVOLIbWgdRYMzfI768elHqztnBPsZXQdholIjbmG1WrQDmqxsjPd5zeYWAfBextOpDNrWp7iGqGjFUYl2B5Z2uSbnsb9CIVz9yaXo7yiYT4+hV6CVpbNACG7KgIf0M3F8V68EcraUK/eGOfohu8mtZS0Pm4NQJlFPo4gdaranuHtctIYASFUI8hedU73Tv7hjpVoy0xM3iZqO6TxBEnz4SQkFizIzBeILxhC06PRni6uemEtWDXeh4aWKL8d5pOp7QzuTL6nOwnPQS2p/A4+j1VQnqTgZeOPcSNObQZf+JV7/xqXdv68WkHo9v7Irb60HCeQexkNDZUdMsdrzHTOxb7+8uL86vb3/Z47fgNHqW3NzhmSi2GBD68so5XG4ezsHIQ1qvLOy4f02Fm716u6pGll8n91/8SJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkfKP4B7r+tvEAKAAA"