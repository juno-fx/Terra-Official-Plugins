apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1X3U/jRhDn2X/FXKjUh2KbAAnVVa2EgIdIlJ4O6EuvQhtng1fYu+7uOiSt+r93xrtOnE84xPVU1YOEnfV87Xz8ZtckWhTWxHtfkA6RTk971RNp9dl4PznuHuF7t3uED+h9SadqKo1lGmBPK2V38T33/T9KxuefS6tnhRLSRiZ9YxuU2X7/ZFv+u93D/kr+j0/7vT04fGM/NtL/PP/77+KhkPGQmTQIDLcQ8oAnqYLODcbFCvkAi9IAVy1RFHWCYB+SlCePYFNm8R+Hi8ub28H12e3gl2uUmQitZI6yMGFasGHGQRhAC4EYw28Q/gmdbxoSHfj9B9IiAwBn/yXqpLKkMoLLqSBf0S8Ux3foBmOx8BFNkoeD65vbs6urXd5VPkBZjJjllYyZGctz77REp//yWv5uugwQxUJiKWUZ19hBK5vb5Mz51eXZ9d2HF4SKrHrups190DxXE+fmBTcYAGaFkjASmidW6dk8lucZZ5JyWRYV92gTd5VWAJ1DqMerG1jShFoSlRcZt3wU0ea+dhW39Fqq8b9ZvG9t4xn873W7J6v43+sdtfj/b5CHfASnYSmyUQ13rLAeBKtXXx0QzuBB2CDwEHh/Mfj44xJQxIgL41kpOoR2I7BqO9wE+SO+Q1gg1DT0dQKUW1khZZmSDuk0L5QRpIGQFKF+pLiR31rCfYOjYDBfdCsH5AgOL0XLTI5qcBc1vKK52uu1IXROH+4GC6+BZZqz0czpNhHckTYaPQ490ZZXhj8wVlCUGDelxYOQkDMMrg54ZngDUFWFzLWlxfa8RlLidp9aW5j3cYwraTmM0I4LN5NKznJVmtgriUgmDEe8sCl0Gw41vHMTqUBzTLvAFjObYoIa8ygoRDHPfTkhgfqXZ/YJ9lWzTxlppi4uZvdeIk6cSHgcdY+ibjfMhCyn4fT7/n3/JHyQpUsZTXSftmoS1/bqbL2r8vVaG+sJHjhJysAHtyUv66NfTuqtzntgjPMRQgELu7XMcmaX9c0Lp0ZaNzmr2sYP/rSBobcly5YOBRuqvBmLaILMGyqXlNK2Nqj0e3OMd6ax+bFW+ftXp7A6SjoeHzvyDSoP1xr91YqXgvzrhoCttGgVZqNKnXDnSqWNJVZMCN8ow40yD0OpwoThUY3SrPkfJbY+qTWRndpmC/hOwq6WD9jV1Fs4TFR+LxUCXhBUjavkWDxUIBBpjqdsDmNG/q+dBl3nhj8zyVBbA3DcLg4aZXAA5hE9ThxyrKFYmDsdW9Fsg5GVkFF97EKpuYbPQ6vMjjSiJYtX1ax4TglbQNV8dR1OhfzM9KHWKIop+sisnqrQq9IWJUU4x7xl+Gym8aAaGUIixzxcAnEKgS9lePZ+0gJbt+A6F8bgfDNbxlpcGszIto8IngUOvhQ9gPAjnPZ6G6V3MDyrwe1yJ4vb/06WZmh2MlYRqyY3ToaC7h2sWW4YU496DOju6W+W7jL5JKi75qcHNjQqKynKDMeZqvoF9W48VECRlaaSqrtz2aguZQMDPLJTHUXFDGsnw+rHoXMYVX+uWgJ3IZqQ7L3Xiodkf0tu3J878NNmHlTzaSk6nzrIu4X5xd7hApd0WQwTpU2YYv9Sz6/rxVjl7NHfZl2Y+ZQnpSVhn8PvpmtSywcg318u3BRJPDiuXAODr32WbamlllpqqaWWWmqppZZaaqmlllpqqaWWlukf15J+9gAoAAA="