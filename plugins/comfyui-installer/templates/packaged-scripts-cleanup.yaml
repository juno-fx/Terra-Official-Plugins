apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1W32/bNhDOs/+KqzJgwFpJcZrEwAYMCNo8GAjSYUn2sg4BLdEREYnkSMqJ9tfv+MO2bMudH1q0xfgFiC2K993dd8ejdaGYNDo/+oI4QUzOz90nYvtz9/t4fHpydgTnXzKoJVptiAI4UkKYT+37r/ffKXSoP+VGdVIwbjJdfWYftqgXZ2f76n92ejHeqv/byfnFEZx85jgG8T+v//GrfMZ4PiO6Go00NZDSES0qAckt6mIYf4R1a4DvlizLktHoGIqKFk9gKmLwH4X3V7d305vLu+mHG7RZMCV4g7awIIqRWU2BaUAPIzaHPyH9B5IfehYJ/PWLZeEjAO//EDoujKXM4OqF2VgxLjTH7zAezdk6RnRpI5ze3N5dXl9/KjoXA7SyJIY6G91pQ5sQNMegA0k/4GOYtawul3sBiDSBIzwwjm1W15B28MjMyNkUJRjhfJRUY/TEMMGhZIoWRqgO9zRP+ASp3JIK36Dt1pqnrAX3YSsqhWaWxyaPgpSCav6jsepoFGy6WvQrbywllljYZcLLpQQYLIBPHl0Wopl3LevnvizXO/vqfrqOH0itKCk7z68zuLeMtkiZK5NLIhC6RxQGZIsiCcUeGYeGoJrKFrTWtO8Jk7R9ufS4TnXFbKm8FpUxUv+c57hStbMM/eXOJ+GCd41odR5oMmuTpiWVpoLxRmAbcdq2slJLdEuUF1t2psLS9doKt0gmV2VvF6E+qEjoK9xqWlJv9OJApdCsXSwdrLpoDin2BcP1h+Xa22x8uizVK1esbIHcg6WyUVgFB2JYSYherT04lp0ezIMg+TqC/Cc3SXyoyW7Z/hhIeKtFEq8vgBatKqj37VhJYdjCHycrR0/aNOUiLQiec6uJon+32ICWXGfmJZw07COJDQ2k353Y46EcBOz4C8PNz7NnhtTrA0pmWtQtbpUEu0O4aeKYB08uyLrVzi6otOVWtbyXWqhtQxjPZIf51KgFzqCTzP35w55lq7nYm9gJ/GrJHoIbvLlXu9Dm42DFPiZotdfs4LCGSJwiWBPx7JIXrZGt0W+gESX2Ak4YvGtF88DxEZ+sEozjjpU6DIcRCl6RBYVnxazcVDVMa1RXWx0qZIL0d5hMJnva0ftMDtvs4zpwcz/4A01cdmEyN+Qp3Ce+y+gLLVpjL54V1+uXAUE3h2toet9vVkC8sbCv0UTW1NAST9DAtffu+ury5v63Ay5le7+F3Zv3Gx4psfAJvN9zWS2HMyVuOmNYe6+2MGRUg0d2vnu59Zh2k/vaP5giIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIr5h/AvAiwNBACgAAA=="