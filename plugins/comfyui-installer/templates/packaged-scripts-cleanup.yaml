apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1W32/bNhDOs/6KqzNgQFdJdpPUwAYMCNo8GAjSYUn20g4BLdEREYnkSMqJ99fv+EO2bMudH9oNw/gFiCWad/fxu+OddaGYNDo/+YYYI6YXF+4Tsfu5/zyZvB2fn8DFtyTVodWGKIATJYT50r6/+/4/Ch3yT7lRKykYN5muvnIMm9R35+eH8n9+dnaxk/+z6bvxCYy/Mo9B/M/zf/oqnzOez4mukkRTAylNaFEJGN2iLobxR9iUBvhqybJslCSnUFS0eAJTEYP/KHy4ur2b3VzezT7eoM2SKcEbtIUlUYzMawpMA0ZI2AI+QfonjL7rWYzg95+sF54A+PjHuOPCWJcZXL0wyxV5oTk+wyRZsA1HDGkZzm5u7y6vr7/EznGAVpbEUGejV9rQJpDmSDo46RM+hXnL6rLbC0CkCT7CC+NYZnUN6QoemUmcTVGCES5GSTWyJ4YJDiVTtDBCrXBP84RvkModqfAbtN1Z8y5rwT1tRaXQzPqxh0dBSkE1/95YdTQKNlsv+pU31iWmWNhlwstOAiQL4A+PIQvRLFYt65+9S9d7+9X9bMMfSK0oKVfev87g3nq0ScpcmtwhgkP3isKAbFEkodgj49AQVFPZhNaa9iPhIW1ddhE3R117tq68FpUxUv+Y57hStfMM4+UuJuGCrxrR6jy4yaxNmpZUmgomW8S2eNqyslJLDEuUF1uuTIWp65UVbpFMrtPeLkN+UJFQV7jVtKTeqsWBTKFZu+wCrKtoASnWBcP1h27tLJu89YWxWbQltITCW7/uHrqEvnIpzZbIYDChlqvVeYDpWmjkZu3Bedmr1DzIlm8o5YGE6zr+cbSf4t8GxNkpp5HPBYAWrSqoZ+C8ksKwpb96VrpeGtKUi7Qg2BOsfor+0WKxWuc6My/hVmLNSSx+IP1KxvsQUkfAtsrQCH3ve2boenOZyVyLusWtkmAlCdd5nOfBWw6ybrWzC1rthFUt7x0t1EFDGM/kCs9ToxbYr8aZ+/P5z7J1D+119xH8bJ09hDA45de70ObzYN4+j9DqoNnRtIacOEUwJ+LZHV60RrZGv4FGlFgL2I1wLovmgeMrvlklGMcda3UYNi4UvCJLCs+KWbmpapjWqK62OlToCdJfYTqdHihKH3N03GbP68jNffJHmrjThS7ekKcwe3yV0RdatMYOqbWvH14GBN1uxKHofb1ZAXG6YV2jiaypoSXeoIER+f766vLm/pcjBridhWH39izEKyWW/gAfDgy2rpFT4jo50jo4BkOrUQ1e2cX+IOx52j/cv/3jKiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiLiH8ZfmcaOuQAoAAA="