apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WXW/bNhTNs3/FrTNgQFdJcerMwAYMCNo8GAjSYUn20g4BLdEREYnkSMqJ9+t3+SFZtuXODymGYTwBYovi/Tr38NI6V0wanZ18Q5whZhcX7hOx+7n/fTI5P5uewMW3TKpFow1RACdKCPO1ff/0/j8KHfpPuVFrKRg3qS5fOYZt6o/T6aH+T6eT3f6/n12cn8DZK+cxiP95/0/fZAvGswXR5WikqYGEjmheChjfIi+G8UfYSAO8WtI0HY9Gp5CXNH8CUxKD/yh8vLq9m99c3s0/3aDNiinBa7SFFVGMLCoKTANGGLElfIbkLxh/17MYwx8/Wy98BODjH+OOC2NdpnD1wmyumBea43eYjJZskyOGtBnOb27vLq+vv5adywEaWRBDnY1ea0PrkDTHpIOTfsKnsGhYVbR7AYg0wUd4YBxlVlWQrOGRmZGzyQswwsUoqMbsiWGCQ8EUzY1Qa9xTP+ETJHKHKnyDtjtr3mUluE9bUSk0s35s8UhIIajm3xvLjkbC5t2iX3lnXWKLhV0mvGgpwGQBfPEYMhf1ct2wfu1tuz7YV/fzTf5AKkVJsfb+dQr31qNtUura5IoIDt0jEgOyQZKEYo+MQ02QTWUbWmnaj4RFWl22ETeldp6tK89FaYzUP2UZrpTNIsV4mYtJuODrWjQ6C25Sa5MkBZWmhMlWYlt5WllZqiWGJcqTLdemxNb1ZIVbJJNd25uVN2qfg0FofyebZtW+6fSyhAQVwHD9oV17n07OvQQ2i1YsK8i99dv2i9+VpllQB/YjqBoTNQ2ptk7CgE7a3r9x3U9XuH2w99axbcmA264nWJy1B+dlT9RZYDjb1JSFKtyA8l/H+2r4faCSHeWNfdsAtGhUTn0GzivJDVv5U2q573UsSbhIcoLjwzZA0T8b1LV1rlPzEg4wdk3iOQHSFz0encAzATtVw8z0Y/KZoevNuScLLaoGt0qCohNuSDnPgwMBZNVoZxe42gmrGt4rLQipJoynco31VMgFjraz1P210ujGbe8iGMMv1tlDCIM/CLpdaPNlsG9fxmh10OzotIacOEawJ+LZFS8aIxuj30EtCtQCDi68wkX9wPERnywTjOOOjh2GMw4JL8mKwrNilm6qaqY1sqstDyV6guQ3mM1mB0TpY46P2+zzOnJzP/kjTVx1YeDX5ClcU15l9IXmjbH3Wefrh5cBQrdndhC915slEC9C1DWayIoaWuAJGrhNP1xfXd7c/3rEXW+vzbB7+9rEIyVWvoCPB+7AduZT4oY+pnXwxgyjRtV4ZJf7d2bP035x//bvsIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiI18DfF6/VwwAoAAA="