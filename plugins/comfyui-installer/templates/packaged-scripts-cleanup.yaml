apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1XbU/jRhDmc37FXKjUD8U2uQNSXaVK6I4PSHf0VKBfehXa2Bu8wt519yUk/fWdfbHjBANB4tRW3QdE4vXOy84zMzuoXLJGq2zvG+IQMT0+dp+I7c+H3yeTt4dHe3D8LZ1qYZQmEmBPCqGf2vfc+/8oVOCfci1XjWBcp6p8ZRuW1JOjo8f4P54eTrf4fzc9Qf4PX9mPQfzP+d9/k80Yz2ZElaORohoSOqJ5KWB8iXHRjN/COjXAZ0uapuPRaB/ykuZ3oEui8Q+Fj2eXV+cXp1fnv1ygzIJJwWuUhQWRjMwqCkwBWhixOfwOyV8w/q4nMYY/frJa+AjA299FHRfaqkzhbMmsr+gXiuN3mIzmbO0jmrQenl9cXp1++vSUd84HME1BNHUyaqU0rYPTHJ0OSvoO78PMsKpo9wKQRgcd4YFxTLOqgmQFt0yPnExegBbORkEVek80ExwKJmmuhVzhnvoOnyBptkKFb1B2a82rrAT3bkvaCMWsHnt4DEghqOLfaxsdhQE77xb9yoFViRQLu0x40YYAnQXwh0eTuajnK8P6Z2/p+mBfXZ+v/QdSSUqKldevUri2Gi1JqaPJHSIodI8YGGgMBklIdss41ASjKS2hlaJ9S3hIm5etxfVRO81WlY9FqXWj3mcZrpRmlqK9zNkkXPBVLYzKgprUyiRJQRtdwmTDsQ0/bVrZUDdolkgf7GalS6Sul1a4pWFNR7tZeKH2OQgE+ru0MYv2TZcvc0gwAxiu37Rr79LJ23QyCYxjjEOmonFtSLWR3QPct3y+cYymC9w+yKdVbMM8oLaLs996rey+L97zuRT1e+jnZhaCl63PkOX+nEk4S1IxbpbJ8seTm5Oj5JYb15T8Hm8JQ2M9Befvg5J4BRNbSfbbQDC3EnrsswFACSNz6l1zWkmu2cIXv6W0lwhJwkWSE+xKlldJ/zRYLla5SvVSbyZJOBPWAb91dWDzEK8rUd9wgS3D89/vbyGVk8+EExTp1aJ3+aCXDweg7tCx3BfTQJEntdfyRLEPGNqKkU+Upwu40/LSQq50IbGlkGxb0dYJWp7Wddx787DrMP5i3pzuNM3w13OIMuLecSKMbowNfY2cVfjZp/DAtVrGcUcXQ4YtGRtDSRYU7iXD4m6orJlSeDuoRy+FrgKMQsqe34YNp3EXSYl+QfIrTKfTZzTusPUFWn1cdtzsY7fj5n6AdxRxDIQ7FHtxg7cfkH5WI0uh0xKws1KYhPzwc89stXa3OZkpURnLG8GrRLjSdJoHr3loKqOcXFvvm2al4b3OEq4Hm6Rps8K0rLDMcGA5TN1Pm4jdENUb78bws1V2E8zgmN/tQpmvg4H5OkapR8V2dmtIiYtITe7ClOXDSZc0N9qOYx1vPywHJDdHjlCkPrA2ZjjHIYEo0lRU0wJ7ycAw+OHT2enF9ZcdRlU79YXdm1MftgCx8Af4+MgI13Y8SlzLQ7ceHfhC05M1tpj5w5Gvp+nh4f7pfyMiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIv5F+Bua0THtACgAAA=="