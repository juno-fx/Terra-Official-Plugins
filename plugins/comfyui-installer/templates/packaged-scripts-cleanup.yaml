apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WW2/bNhTOs37FqTOgD6vkeHVmoAUKBG0eDATZsCR9WYeClpiIiERyvDjRfv0OL5ZlR+n80GIoyi9AHMnn+n2Hh9GlYtLo6dE3xAlicXrqPxH7n0//ns1+OZkfwem3LGoDqw1RAEdKCPMlu//6/juFjvpTblQnBeOm0PVXzuFE/XU+f07/+Ww+29P/9eL09RGcfOU6RvGD63/8YrpifLoius4yTQ3kNKNlLWByhbwYxu9gOxoQpqUoikmWHUNZ0/IeTE0M/qLw4fzqenl5dr387RJ91kwJ3qIvrIliZNVQYBowQ8Zu4U/I/4HJTwOPCfz11kXhGUDIf0g4LowLWcD5I3O1Yl3ojn/DLLtl2xoxpatweXl1fXZx8aXqfA1gZUUM9T6604a2sWiORccgw4KPYWVZU21sAYg0MUZ8YBzHrGkg7+COmcz7lBUY4XNUVGP1xDDBoWKKlkaoDm3ae3yCXO5Rhd+g7967ELIRPJStqBSauTiueSSkElTzl8axo5GwZf8yvHnlQqLEwr0mvNpQgMUChOYxZSna286yYe8bud67r26W2/qBNIqSqgvxdQE3LqITqfAy+SZiQP+IxIC0SJJQ7I5xaAmyqZygjabDTNikm8tNxm2rfWQXKnBRGyP1m+kU39R2VWC+qc9JuOBdK6yexjCF88nzikpTw2ynsJ063Vg5qiWmJSqQLTtTo3SDsUITyWQvu11HfZCROFdoaixpdmZxRCl0Uy3k6haKNZpuxHjh5fCvRsVweRxHI1l6kuwanH8feI/mjyMF7kk6CXwAaGFVSUMkv09Iadg6jD+mGVKR51zkJcFziV2hdn9bHBgXXBfmMZ4M1F3iAAIZThPOZKSPgFtXcRmF/fPAMPT2QJGVFo1FU0lQTeFPv488etJANlZ7vyjzXlpl+aC1KHZLGC9kh/00yAXujJPC/4TDWRT9Hhts2Am8c8E+xzR40/ZW6PNp50RPo9GnCXo963ZwWWNBPCOoiXjwzQtrpDX6FbSiwlnAjYB3o2g/c3zEJ8cE42jRs8NweSDhNVlTeFDM0U1Vy7RGdrXjocZIkP8Bi8UCRpubhpyTw4xDXQcaD4s/0MV3FzdpS+7j/g9TRh9paY27KPpYPz+OELq7DOPQh3lzBOINg3ONLrKhhlZ4gkauqfcX52eXN78fcIm6+yha795HeKTEOjTw4ZnLZbNMKfHbFMt69iqKKyMuoieX0SDS0+b+739wEhISEhISEhISEhISEhISEhISEhISEhISEhJ+IPwLJ2/zUAAoAAA="