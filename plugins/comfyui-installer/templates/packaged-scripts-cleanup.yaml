apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1VXW/bNhTNs37FnTNgD61lp41roAMGBG0eDATZsCRP7VDQEhMRlUiOpJxov36HFG3LqdP5ocXQlseALdL389wP2cII7ezk6CtiCsxns/ALPP799Pnk5MX09IhmXzOoNVrrmCE6Mkq5z8n91//fKGysP5fOdFoJ6XJbfWEfvqivTk+fqv/L2ezFo/q/nL+aHtH0C8exFz94/Y9/miyFnCyZrbLMckdjnvGiUjS6Ai9OyDvatgb13ZLn+SjLjqmoePGRXMUcvji9Pb+6XlyeXS9+v4TOShglG+jSihnBljUnYQkeMnFL72j8D41+HmiM6K9fvRWZEfX+DzEnlfMmczp/ED5WxAV1PNNJdiu2McKlj3BxeXV9dnHxuehCDNTqkjkedGxnHW9i0BJBRyPDgI9p2Yq6XMsSMe2ijXgQEm1W1zTu6E64LOgUJTkVfJTcInrmhJJUCsMLp0wHGUjskhQVayX74AzXygov7VNE2qXiVv7iPAcWtCw2l/3Nc28ShVT+mslynShCIupThMtCNbddK4YZrovyxv91s9hGSaw2nJVdb9/mdOMt+lLkoRghiWgwHJE+6RZUKCPuhKSGiVDz2vKhH6Toe2/tb5voxq431DNROaft68kEN1W7zOFtEjwyqWTXqNZOopnc64zHJdeuopOdsHai9K3jidZwy0xPte5chfIMWgciWuhNadsVLtoVrSCCJ6taU3DK/TGMGCucWPUdAamh5tggv79bUOrN2tw9xA5BN2mUiNiQb1StAOWoGiM/tnEo+zm8F7C3bSy2tKpuIaoZMlZhCoLlvR1Hum5t0ItUPHJrWjnIJxLi65frDrTWaADMzjQPn75983wzz4NNM6LfvLEP0Q3eOBsp6Lzf6flJFHo/gtaTageHtc9IYASFUPchedU63Tr7nBpVoi0xM3hHqOaDxBEnz4SQkNiwIzBeILxiK073Rni6uWmEtWDXeh4qWKLxnzSfz2lvcpPoc3SYdB/YgcLD6A9UCenFZdOwj3ER9m3GH3jROr8xN7aePexhdHdfxFbvG84ziFWLxoaKrrnjJWZ6z75+c3F+dnnzxwFvE7+Yo/TuYsZMqVWfwNsntux643AWVg7CenInx+VjGszs7ePdvGPp0+T+7zd9QkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkLC945/AVSl+asAKAAA"