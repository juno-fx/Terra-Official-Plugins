apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1XWW/jNhDOs37FrFNgHxpJURI7xRYtECR5MJCmi03Sl24R0DJtEZFIlaQcu8X+9w4P2fKZA9kuimoCRDI1F+f4hlSpZKVW8d5XpEOk09OufSKtPhvvJ8fJEb4nyRE+oPs1naqpUppIgD0phN7F99T3/ygpn3/KtZyVgnEdqeyNbZjM9non2/KfJElvJf/Hp73eHhy+sR8b6X+e//138YDxeEBUFgSKaghpQNNMQOcG46IZH8OiNMBVSxRFnSDYhzSj6QPojGj8R+Hi8ua2f3122//1GmUmTApeoCxMiGRkkFNgCtBCwEbwO4R/Qee7hkQH/vjRaOEBgLP/HHVcaKMygsspM76iXyiO75AEI7bwEU0aD/vXN7dnV1e7vLM+QFUOiaZWRs2UpoV3mqPTf3stX5ouA0Qx41hKeU4ldtDK5jY5c351eXZ99/EZoTJWPXfT5j5IWoiJc/OCKgwA0UxwGDJJUy3kbB7L85wSbnJZlZZ7uInbphVAFhDK0fIG4lQUo1nFOssaURt+KHOq6TAym/zW1dzSS6nG/2bxvrWNJ/C/myQnq/jf7R61+P9vkId8BKdBxfJhDXek1B4E7auvDghnMGY6CDwE3l/0P/20BSgQ7YagxXa4CYoHfIewRKhp6OsEKLeyYpTlgjukk7QUihkNBkkR6oeCKv5eG9xXOAr680W3cmAcweElzDLhwxrcWQ2vaK72em0InZsPd/2F10BySclw5nSrCO6MNjN6HHqiLa8Mf2CsoKwwbkKyMeNQEAyuDGiuaANIhUXm2tJie16jUeJ2n2ldqg9xjCtZNYjQjgs34YLPClGp2CuJjEwYDmmpM0gaDjW8cxOpRHNEusCWM51hghrzKChZOc99NTEC9S/P7BPsq2bfZKSZuric3XuJOHUi4XGUHEVJEuaMV9Nw+kPvvncSjnnlUmYmuk+bncS1vTpb72y+XmtjPcF9J2ky8NFtycv66FeTeqvzHhjhfISQwcJuLbOc2WV988KpkdZNTFvb+MGfNjD0uiL50qFgQ5U3YxFNkHlD5RqlZlsbVPq9OcY71dj8SIriw6tTaI+SjsfHzvgG1sO1Rn+14qUg/7YhYCstasOsRCVT6lyx2kiq2cTgm8lwo8zDkIswJXhUM2mW9M8KW9+oVZGe6mYL+E7CruZj7GrTWzhMRHHPBQJeENjGFXzExhYEIknxlE1hRIz/a6dB17nhL4QT1NYAHLeLg0YZHIB6QI9ThxxrKBYWTsdWNNtgZCVkpj52odRcw8vQKtdDiWhJ4lU1K56bhC2gar66DqeMvzB9qDWKYhN9ZBaPNvSi0mVlIlxg3nJ8NtN4YEcG48gxDxdDnELgywievR8lw9YtqSyYUjjf1JaxFlcKM7LtI4JniYMvQw8g/ASn3e5G6R0MT2pwu9zJ4va/k6UZmp2MNmJ2cuNkKM29gzTLDWPqUY+AuXv6m6W7TD4y013z0wMZKJFXJsoEx5mw/YJ6Nx4qoMwrZaXq7lw2KivewACP7KaOonKGtZNj9ePQOYzsn6uWwF2IJkb23mvFQ7K/JTfuzx34eTMPqvm8FJ3PHeTdwvxs73CBcnNZDFMhVZhh/5qeX9eLsSrIg7/NujDTKU0rbYR9Dr+frkktH4B8f7lwm0jiwXHl+hd867NsSy211FJLLbXUUksttdRSSy211FJLLbW0TP8A3Ru+BAAoAAA="