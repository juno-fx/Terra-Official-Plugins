apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1WXW/bNhTNs3/FrTNgQFdJceLUwAYMCNo8GAiyYUn2sg4BLdEREYnkSMqJ9+t3+SFZtuXOGFoMw3gCxBbFe+7X4aV1rpg0Ojv5ijhDzC4v3Sdi93P/+2RyfjY9gcuvGVSLRhuiAE6UEOZz+/7u/X8UOvSfcqPWUjBuUl1+YR+2qe+n00P9n07PL3b6fzG7fH8CZ184jkH8z/t/+iZbMJ4tiC5HI00NJHRE81LA+A7rYhh/go00wKslTdPxaHQKeUnzZzAlMfiPwsfru/v57dX9/KdbtFkxJXiNtrAiipFFRYFpQA8jtoTfIPkTxt/0LMbw+w+WhY8AvP9j6LgwljKF61dmY8W40By/w2S0ZJsY0aWNcH57d391c/O56FwM0MiCGOps9FobWoegOQYdSPoBn8KiYVXR7gUg0gSO8MA4yqyqIFnDEzMjZ5MXYITzUVCN0RPDBIeCKZoboda4p37GJ0jkTqnwDdrurHnKSnAftqJSaGZ5bPJYkEJQzb81tjoaCzbvFv3KO0uJLRZ2mfCiLQEGC+CTR5e5qJfrhvVzb9v1wb56mG/iB1IpSoq159cpPFhG26TUtcklEQjdIxYGZINFEoo9MQ41wWoq29BK074nTNLqsvW4SbVjtlS+FqUxUn+fZbhSNosU/WXOJ+GCr2vR6CzQpNYmSQoqTQmTrcC24rSysqWW6JYoX2y5NiW2ricr3CKZ7NrerLxR+xwMQvs72TSr9k2nlyUkqACG64/t2kU6OfcS2Czis6px6xLeWt2sIPdEb9sv3iBNsyAUbE0QOMZsGlJtHYoBybQyeOOEkK5w+6AMLLHtzgBt1x7M09qDY9nTdxaKnW3Sy0IWblb5r+N9Yfw6kMmOCMe+gwBaNCqnPgLHSnLDVv7A2jb0mpckXCQ5wUlie6HoHw1K3JLr1LyGs4wNlHhkgPT1j6co1JmAHbBhfPqJ+cKQejMCyEKLqsGtkqD+hJtXjnlwNoCsGu3sQq123KqG91ILmqoJ46lcYz4V1gKn3Fnq/lppdJO3dyeM4UdL9hjc4G+DbhfafBrs26cxWh00OzqsIRJXEeyJeHHJi8bIxuh3UIsCtYAzDG9zUT9yfMQnWwnGcUdXHYbjDgtekhWFF8VsuamqmdZYXW3rUCITJL/AbDY7IErvc3zcZh/XkZv7wR9p4rILs78mz+HG8iqjrzRvjL3aOq7vXgcKuj2+g+i93mwB8U5EXaOJrKihBZ6ggYv1w8311e3Dz0dc+/YGDbu3b1A8UmLlE/h44Dpsxz8lbv5jWAcvzzBqwkzcuz57TPvJ/ds/ySIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIi/jH+AqlRorcAKAAA"