apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3SzXKCMBAHcM48xarXimgFn6Hn9gUCrJI2Jkw+xvr2DUXH1n5ddDqd/n8HkiG7ycLG1VZ23s2SK8rzfLEqin7snY8f5/P5Ii8TKq5Z1FFwXliixBrjv4v7af2Pcof+s/Z23xmpfebaC5/RN7VcLr/s/7JYnfX/dlXOE8ovXMen/nn/J6NZJfWsEq5NU8eeppxy3Roa38f/4qXe0Olq0HBbsiwbp+mEHlqmdVCKaqN9jHJk1uTjy8OlokZarr2xe9rJGFZxTAq6E/UTN+TNa2wdrI25b2J9K3x8SHfYJybZoB1JndGdHlb4WWw7xTe042Hvx9hHUtL1mf0xp+2cob0JVAtNjnk481iv0E2saiN1zKiCVE3/vTHaktixM1umToW4PEqVo6kS6W+3CwAAAAAAAAAAAAAAAAAAAADgnRdW0cybACgAAA=="