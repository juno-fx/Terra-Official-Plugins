apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3RzU6DQBQFYNbzFFfqFktF2oWrRmvSxNCm1pVxQWGQiXQgzMXYt3fa2E2xuikxxvNthrmX+ckck9SqYtN3OuRbo1G4G63Dsf09GFz6Q4fCLi+11xiOayKnLkv+7r+f+n+U+cxfaq43Vak0X5j8xGdsQx0Or47mHwThQf7BKLT5+ye+x5f+ef69s/5K6f4qNrkwksmTQqiMnsjT5J7f3E/G0ePcpedr4lxqQVSvyavfMtu8nTwsp9F4OZ1Frm3Id8XkC1kYaWdxxdRUacz7idL2oYuCvA29KBa22qNFo7fbUlKu17FObc22KClKLe3+i8l85rbPSdJ2bbcsl8lr2fBu5Z0rMiV++3EBAAAAAAAAAAAAAAAAAAAAADr2AUISxSwAKAAA"