apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3RQU/CMBQH8J37KZ7D66Rj1B08EcWExABBPBkPYxTXOLplbY18ewu6C+gN1MT/7/La99K+ps/kjaqt6QYnxL1UiG2MU8E/YrKLrSAWPOaC94ToBX6V9uKAxCkf1XLGZg1R4BZOW/cTHf8U8zl/qW2zqSul7YUpjtxjO+DLfv/b+SeJ2Jt/0k/9/PmR3/Glfz7/zll3oXR3kZmCGWkpkoypFT1SpCk8v74bDsYP05CersgWUjOiZk1R87ryxZvh/Xw0HsxHk3HoC/JNWeJMlkb6XVZbcvUys+1Gaf/RZUnRhp6VZT7boZnT22spr9brTC99zpcoLyst/f2z4XQSHvbJl4e53bFC5i+Vs7uTtyFbKfbbnwsAAAAAAAAAAAAAAAAAAAAAcGLv85IvKQAoAAA="