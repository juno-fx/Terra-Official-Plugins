apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3RTU/CMBgH8J37KR6H17nxMjh4IjoTEjMI4sl4GKNzjaNd2s7It7cjcgHRC8QY/79L1+dZX9K/ybWorQm9M4qiqDeK43Zs7Y+H391uLxp6FJ/zUjuNsZkm8rRS9rv/fur/UeYzfy6t3tRKSHtlyhOf0YY6HAyO5t/vx3v590fxwKPoxPf40j/Pv3MRLoUMl5kpmeGWAs6YKOiJAkn+5c19Mk4fZz49X5MtuWREek2Bfitc8zZ5WEzS8WIyTX3X4O/CUsR4ZbibZbWlpl5ldjcR0j10VVGwoRdhmat2aN7IdlvK1XqdyZWruRbllZLc7T9PZlP/8Jx8dVjbLit5/qoau11557NCsN9+XAAAAAAAAAAAAAAAAAAAAACAM/sA9P+pFwAoAAA="