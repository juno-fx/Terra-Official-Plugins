apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3SzXKCMBAHcM48xarXiloVnqHn9gUCREkbEyYfY337LqJja78uOh2n/9+BZMhusrDxlVNt8JPkiqasKJb7kZ2Pn+ez2f00T2h5zaKOog/CESXO2vBT3G/rN8of+i9NcLvWKhMy31z4jK6peb74tv+LZXHW/3mRzxOaXriOL/3z/o8Gk1KZSSl8k6ZeBhrLVFaNpeEj/5egzJpOV4P625Jl2TBNR/TUSFpFramyJnCUJ7uiwC8Pl4pq5WQVrNvRVnFYKTkpmlZUL7KmYPexVXSOc9/FhkYEfih/2IeTXDSelMnowfQr8lVsWi3vaCv7vZ+5j6SV7zK7Y07beUs7G6kShryU/ZnHeoWpuaq1MpxRRqXr7ns52pHYSm83klodeXmQak9jLdK/bhcAAAAAAAAAAAAAAAAAAAAAwAdv4DygoAAoAAA="