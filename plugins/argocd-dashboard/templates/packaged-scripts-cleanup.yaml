apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+2Y627bNhTH81lPcaIa6zbU8iWxA3hwAcP1hmFrG7goMCAOAlqibS0SqZKUW8/wO29PsB3q4sj3JHBSbOP/gyVT5LmQ1PnRlq7wIyUrJ0+oKuriopFcUevX5P7vpf76s1pr1mqNE2g8ZVC5YqmIADgRnKt9/Q49/5dKZuvvBpSwOHLk5Pg+Dqx/vX5xvrr+9WqtVj2B6vFD2dT/fP1fnFaGPqsMiZxYlqQKytSyOv2f3nff3LzrvO19uOx0e20ixtz1LEvQkE/pjcvZyB+HJLq5pbNvv4O5BaiAuyQAN7xhJKRtu1SzC83YEZvqaVPyQd0JB7uvLfpsrDvAy9IcL4uXMBI8hG7i5S2JoDTPrC4K4/0RnMJtPKSuCmCMkS+jArswAMpMf19PCR+8rnh0WmFxEED99Te1H0BNKEtM34W3LQbwOJXAuAL6xZfqFchbP4owB8dx7OV4QVUsGFSThpF/xLjLHH6XnEVETdr23PGIIk46cfdM6pfiVK8mAz7bOu8PTTLPD4N0Jw/OcLB0UC6rWUSTfIutaOhqPrB5NLBbMLDTbTmwX+G9npa0taJnppLmObAX17a1sKxsWXW107sujqCDe7v75i5rmWS43jF9A8pumDzd9h6Avexjgx1LKqRDGGezkMfSoYwMA+rtMeyVIyJIKO/po9Ad3aG3KRWOLlJ6Ah432vOlDtIh8WMtfHFG2EYdHimfM7kzWzEkbp5n1mVjGSBDEu6eMAqooh7I2HWplCPc3bNT2/ratfO/oCX/k3mPBX2CE8BB/p+drfP//Kxh+P8cehj/X0B3Qt1bzbDLfu/Hn38DX4IeRZiXQiSM1MzCx1dXUP5Dl/e0X6uMZf36uoCj9K3v9fvv+63cGGVTX3AWUqZgSoSvqxGEuEIwpJtuUgwhthTULISPlcDmrmA94mCSNk1JEOt+ZxunlUvtQdexreeCz76aQMqbdmmeWCkeWI7MxJCKMV2DIjJRQw/5h3c5+Vr6No0GMbgoYjB76XVGezH4MUKzmxhcm/BVAhIv9NmSe2ArEdMDQ3ZBMx+8M5p1du72sh+bdxt28WAjK/Q8nO69+In9g4B/Lifn4e93TkARp7s8Zn3QZMQD3505Hh2ROFDYIHhAW8ly7aNxtleIjmw3k618l6PRgMcKj4i6wCrwaBTwWfJqZxGlOe/c8Qbvz6Gc/7guYhZxn6njHwA05JvN853//zSqzXX+N5uG/8+iIv9z/Gt8b6H3JryF4GI/vPF4IOin2BdYKYZYDTS80c0GuhOX6K/7a6/z7uNl4rCdFdEtnvsxS35O5D8REvJmsUIpvUl9OIV/tiwaSFqw8kEXpgL7VkvcXpuF07KO/2uvopGRkZGRkZGRkZGRkZGRkZGR0Xb9Aza86qkAKAAA"