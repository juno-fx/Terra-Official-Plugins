apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap-cleanup
  annotations:
    argocd.argoproj.io/hook: PostDelete
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+1ZbW/bNhDuZ/0K1v06SZZfkkHftm5YO3RNUGfdh2EIaImW2FCkwBcnRtD/vqNExbIz1+3m2OjKJ4BFk8fj0cd77qioTNJaq/jZE2IIOD+fNk/A9rPXnoyTEbSTZAQPNH1KozoYpbFE6JkUQn9Kbt/4Vwrl/J+VWOonOgWN/6df4v/RODn3/j8GNv3/0n5GK1yxQ65hPXs2mez0/3g03vL/ZDQZPUPDQxqxC9+4/3FN3xOpqOApWiZBTtoD0Xz/g8zRHCuSI01kRTlmAccVSdEt0XoVLLt5wwj+AprZdql1rdI4lvg2KqguzdwoImFIE66jTFTxB8NFuLiLr4iUOLxYLGhGMQsvmSkoV7EkCxWXBOcqrjDlce36P5h6BWaEXGgyF+Im7k4uVorAg4lCRDUvguDUP+lXhc3416SqGdbksPXAl+f/ief/I2GX/3NSM7GqbND+53TQ8P/ZTv5PxqPplv/PxyDu+f8I6PM/rmsVQxK4oTxP0U8PJyCoiMY51jgNEGozwP09it4RRiA7RG+hB338GLZZASGG54QpK4usyk8Jq5pkVlDCWjTDKkUJfFMgm2khWxUV1ln5pqdzr1aEunPsNPTMt2Abyj5DHZjkDLWwyQwyE/xqXU+I+nmxU0srXEDnoOkVSsVNI7ULvcfMEBU1EtcaF7DY4GFeLaTuWReuF7yEkRSNIVAeRjuH2Lz70En4sj+/lZjNXr26mF31Zi6tFWBgzyKlyutSKL1hUE/D5cW7z9Bgd7Ch4f4+RHTxIGOLiusa6xKEHq3y4w+znz+9RH/65hqE51blqYPqK8Iu/qe8kESpg9wF9vF/Mjzb4v+zs+nY8/8x0Od/TvStkMD+RXTzPbCTWCeD1+1x2JEJXFxyR5vu7IAI5lCuY3ubcIR2Y+ZEwjqkUd8dsoxBEQ/rQ6F/14g1ragb3pyEjS5DIxlwgiU9uGvAJWPOSLTN4KrGmbUnUssMlgBHExkxkWGWWgqNYeutMrtp1ZoZP95OPFinKcOI20iILE1ubN/xpiOkxrY1pwNb9TjdzrddsIe4FgxLqv55ZdSDnXC1quE3v4RLEr3bGJzj7AbYL93otKlULmlGtrt3O++RoOXyx9NBganAKy4bnfoUe/xb7OJ/d3COwf/DSbL9/gekE8//x8DW+5+W7Wet85++7tcNnb1sufn1ZdArfsOWedbVLripIHqrBK6l0CITkAyuXl4Ga2Jz5fDmTWKPUad2xUmwGf/LNhcc+AXwvve/k8n2/X8yHU59/B8D/YurfVObBnAXF2kAl1LbLKjScpUGhRQGypmsNlCyJANghkpAP7R/oQPb/YZWFAKTG8bcYL+nsPMWmCkS0PwuRcOgMDS3z9o9m2oKvjE2I5kk0FZQ+llaCpaCmYr8JgwHZkB//uU62ra76naXx19/f3sR9K+NWhoCBdwDD7jXyc3c6xtDa7vlAGjkbnXNu6IxRa70DNuS9NROekJ08U84+LkWlOtIlQdeY2/+n55vxf/Yvi728X8EvHgezymP51iVAYSJRiEJSFYKNJjB76IhDtD6aKD2tERRNAiCF+iqJGgBEYvcv3cUEgukodMdKpRT2YTdCt1SEJsTmGR4ba8qOdKikc2MlDC3J6tLrOGDKqcHJknDFcRkBPfQdoTcYahUyXfAXK3uD+BHxICtrFKYsVanBFoJgzLMoRwg7ZqdvZjnYBXEOMyYG8pyu1+QlgjfEiWgOmj54nnAFAoZ/v8xQRf/wIkaMwY35IOH/974T4bJdvxPff1/HPTj34U/xII7DTY4WYBrjUwN9wDSNPtjKFydegMeHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7fEP4G7ClzNABQAAA="