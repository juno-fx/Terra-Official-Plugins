apiVersion: v1
kind: ConfigMap
metadata:
  name: d10webservice-configmap
data:
  run_webservice.sh: |
    #!/bin/bash
    hostname deadline-server
    mono --version
    ulimit -u unlimited
    export DEADLINE_PATH=/apps/deadline10/client
    echo "Starting up Terra service for: Deadline10 Webservice"
    echo "---------------------------------------------"
    mkdir -p /var/lib/Thinkbox/
    mkdir -p /var/lib/Thinkbox/Deadline10
    cp -v /apps/deadline10/service/deadline10.ini /var/lib/Thinkbox/Deadline10/deadline.ini
    cd /apps/deadline10/client/bin/
    ./deadlinewebservice.exe 
    echo "Terra service for Deadline10 Webservice is running"
    # sh -c tail -f /dev/null

  deadline.ini: |
    [ Deadline ]
    NetworkRoot=/apps/deadline10/repository
    LaunchRemoteConnectionServerAtStartup=False
    KeepRemoteConnectionServerRunning=False
    NoGuiMode=True
    LaunchSlaveAtStartup=False
    LaunchWebServiceAtStartup=True
    KeepWebServiceRunning=True