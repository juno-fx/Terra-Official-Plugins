apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3SXVLCMBAH8D73FAu8SikMbc/gs14gTQONhqSTj0FurSfQlIKI48cLjuP4/z00mWY32XbjuJWdd7PkB+VRVRX7MXo/7ufPr54e83k5nxcJFT9Z1FFwnlmixBrjv4r7bv2Pcof+C+3trjNS+8y1Fz6jb3BZLj/t/7Kozvu/yMtqkVB+4To+9M/7PxnNaqlnNXNtmjrhaSpSwVtD45v4X7zUazpdDRpuS5Zl4zSd0G0raBWUIm60j1GOzIp8fHm4VNRIK7g3dkdbGcNqEZOC7hi/Fw15s4/lwdqY+ybWt8zHh3SHfWKSDdqR1Bld62FFPLBNp8QVbcWw913sIynp+sz+mNN2ztDOBOJMkxNiOPNYL9NNrGotdcyog1RN/70x2hLbCmc2gjoV4vIoVY6miqW/3S4AAAAAAAAAAAAAAAAAAAAAgDMv9ldLxQAoAAA="