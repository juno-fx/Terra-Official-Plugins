apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-scripts-configmap
data:
  bootstrap.sh: |
    #!/bin/bash
    echo "Unpacking scripts..."
    # decode base64 encoded scripts mount at /terra/scripts.base64
    base64 -d /terra/scripts.base64 > /terra/scripts.tar.gz
    
    # extract scripts to /terra/scripts
    tar -xzvf /terra/scripts.tar.gz -C /terra/
    
    # make scripts executable
    chmod +x -v /terra/scripts/*.sh
    
    # start entrypoint.sh
    cd /terra/scripts
    pwd
    ./entrypoint.sh
  packaged_scripts.base64: "H4sIAAAAAAAAA+3SXVKDMBAHcJ45xbZ9tZQWImfwWS8QIC3RNGHyMdjbG0o7VUffWnXG/28GMgO72YWNa6zsvVslN5RHFWPjuq5YPq3FcT1L1iwvClZu4pXk67wqNgmxWzZ1FpznligJddA+/ETFP8Wd5i+0t4feSO0z1125xjjg+7L8dv4lqz7Nv2B5lVB+5T6+9M/nv5itaqlXNXddmjrhaSlS0XSG5o/xv3ipd3Q5GjSdlizL5mm6oKdO0DYoRY3RPkY5Mlvy8eHpUFErrWi8sQcaZAyrRUwKuufNi2jJm2NsE6yNue9ifcd9vEl32icm2aAdSZ3Rg57eiFe+75W4o0FMez/HOZKSbswcy1y2c4YOJlDDNTkhpprnfrluY1c7qWNGHaRqx++N0Zb4IJzZC+pViK9nqXK0VDz97XEBAAAAAAAAAAAAAAAAAAAAAHzwBoSMK8UAKAAA"